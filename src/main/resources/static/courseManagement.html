<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Management</title>
    <style>
		body {
		    font-family: Arial, sans-serif;
		    margin: 0;
		    padding: 0;
		    background-color: #f4f4f4;
		}

		.container {
		    width: 80%;
		    margin: 0 auto;
		    padding: 20px;
		    background-color: #fff;
		}

		h1, h2 {
		    text-align: center;
		}

		form {
		    width: 60%;
		    margin: 20px auto;
		    padding: 20px;
		    border: 1px solid #ccc;
		    border-radius: 5px;
		    background-color: #f9f9f9;
		}

		label {
		    display: block;
		    margin: 10px 0 5px;
		}

		input[type="text"], input[type="number"] {
		    width: 100%;
		    padding: 8px;
		    margin-bottom: 10px;
		    border: 1px solid #ccc;
		    border-radius: 5px;
		}

		button {
		    padding: 10px 15px;
		    background-color: #4CAF50;
		    color: white;
		    border: none;
		    cursor: pointer;
		    width: 100%;
		    border-radius: 5px;
		}

		button:hover {
		    background-color: #45a049;
		}

		table {
		    width: 100%;
		    margin-top: 30px;
		    border-collapse: collapse;
		}

		table, th, td {
		    border: 1px solid #ddd;
		}

		th, td {
		    padding: 10px;
		    text-align: center;
		}

		th {
		    background-color: #f2f2f2;
		}

    </style>
</head>
<body>
	<div class="container">
    <h1>Course Management</h1>

    <!-- Form to create a new course -->
    <h2>Create Course</h2>
    <form id="createCourseForm">
        <label for="name">Course Name:</label>
        <input type="text" id="name" required><br><br>

        <label for="description">Description:</label>
        <input type="text" id="description"><br><br>

        <label for="credits">Credits:</label>
        <input type="number" id="credits" required><br><br>

        <label for="instructorId">Instructor ID:</label>
        <input type="number" id="instructorId" required><br><br>

        <button type="button" onclick="createCourse()">Create Course</button>
    </form>

    <p id="createResult"></p>

    <!-- Button to retrieve all courses -->
    <h2>All Courses</h2>
    <button type="button" onclick="getAllCourses()">Load Courses</button>
    <table id="coursesTable">
        <thead>
            <tr>
                <th>Course ID</th>
                <th>Name</th>
                <th>Description</th>
                <th>Credits</th>
                <th>Instructor ID</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Form to update a course -->
    <h2>Update Course</h2>
    <form id="updateCourseForm">
        <label for="updateCourseId">Course ID:</label>
        <input type="number" id="updateCourseId" required><br><br>

        <label for="updateName">Name:</label>
        <input type="text" id="updateName"><br><br>

        <label for="updateDescription">Description:</label>
        <input type="text" id="updateDescription"><br><br>

        <label for="updateCredits">Credits:</label>
        <input type="number" id="updateCredits"><br><br>

        <label for="updateInstructorId">Instructor ID:</label>
        <input type="number" id="updateInstructorId"><br><br>

        <button type="button" onclick="updateCourse()">Update Course</button>
    </form>

    <p id="updateResult"></p>

    <script>
        // Create a new course
        function createCourse() {
            const name = document.getElementById('name').value;
            const description = document.getElementById('description').value;
            const credits = document.getElementById('credits').value;
            const instructorId = document.getElementById('instructorId').value;

            fetch('/courses', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name, descrition: description, credits, insId: { insId: instructorId } })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('createResult').innerText = `Course created with ID: ${data.courseId}`;
                getAllCourses();
            })
            .catch(error => console.error('Error:', error));
        }

        // Retrieve and display all courses
        function getAllCourses() {
            fetch('/courses')
            .then(response => response.json())
            .then(data => {
                const tbody = document.getElementById('coursesTable').querySelector('tbody');
                tbody.innerHTML = '';
                data.forEach(course => {
                    const row = `<tr>
                        <td>${course.courseId}</td>
                        <td>${course.name}</td>
                        <td>${course.descrition}</td>
                        <td>${course.credits}</td>
                         <td>${course.insId ? course.insId.insId : 'No Instructor'}</td>
                        <td>
                            <button onclick="deleteCourse(${course.courseId})">Delete</button>
                        </td>
                    </tr>`;
                    tbody.innerHTML += row;
                });
            })
            .catch(error => console.error('Error:', error));
        }

        // Update a course
        function updateCourse() {
            const courseId = document.getElementById('updateCourseId').value;
            const name = document.getElementById('updateName').value;
            const description = document.getElementById('updateDescription').value;
            const credits = document.getElementById('updateCredits').value;
            const instructorId = document.getElementById('updateInstructorId').value;

            fetch(`/courses/${courseId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name, descrition: description, credits, insId: { insId: instructorId } })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('updateResult').innerText = `Course updated successfully!`;
                getAllCourses();
            })
            .catch(error => console.error('Error:', error));
        }

        // Delete a course
        function deleteCourse(courseId) {
            fetch(`/courses/${courseId}`, {
                method: 'DELETE'
            })
            .then(() => {
                alert(`Course with ID ${courseId} deleted`);
                getAllCourses();
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
	</div>
</body>
</html>
